<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Update Live Score</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { background:#111; color:#fff; font-family:sans-serif; padding:15px; }
    h2 { text-align:center; margin-bottom:15px; }
    .grid {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap:10px;
      margin-bottom:15px;
    }
    input {
      padding:6px; font-size:14px; text-align:center;
      border-radius:6px; border:1px solid #444;
      background:#222; color:#fff;
    }
    .btn {
      width:100%; padding:10px; margin-top:10px;
      font-size:16px; border:none; border-radius:6px;
      background:#28a745; color:#fff; cursor:pointer;
    }
    .btn:hover { background:#218838; }
    .ball-buttons {
      display:grid; grid-template-columns:repeat(6,1fr);
      gap:6px; margin-top:10px;
    }
    .ball-btn {
      padding:8px; border:none; border-radius:5px;
      font-size:14px; cursor:pointer;
    }
    .zero { background:#444; color:#fff; }
    .run { background:#00aa66; color:#fff; }
    .four { background:green; color:#fff; font-weight:bold; }
    .six { background:blue; color:#fff; font-weight:bold; }
    .wicket { background:red; color:#fff; font-weight:bold; }
    .extra { background:yellow; color:#000; font-weight:bold; }
  </style>
</head>
<body>
  <h2>üèè Update Live Score</h2>

  <!-- Teams & Target -->
  <div class="grid">
    <input id="teamA" type="text" placeholder="Team A">
    <input id="teamB" type="text" placeholder="Team B">
    <input id="target" type="number" placeholder="Target Runs">
    <input id="targetWickets" type="number" placeholder="Target Wickets">
    <input id="runs" type="number" placeholder="Runs" value="0" oninput="updateCalculations()">
    <input id="wickets" type="number" placeholder="Wickets" value="0">
    <input id="overs" type="text" placeholder="Overs (e.g. 10.2)" value="0.0" oninput="updateCalculations()">
    <input id="last6" type="text" placeholder="Last 6 Balls">
  </div>

  <!-- Batsmen Section -->
  <h3>Batsmen</h3>
  <div class="grid">
    <input id="batsman1Name" type="text" placeholder="Batsman 1">
    <input id="batsman1R" type="number" placeholder="R" value="0" oninput="updateCalculations()">
    <input id="batsman1B" type="number" placeholder="B" value="0" oninput="updateCalculations()">
    <input id="batsman1F" type="number" placeholder="4s" value="0">
    <input id="batsman1S" type="number" placeholder="6s" value="0">
    <input id="batsman1SR" type="text" placeholder="SR" readonly>
  </div>

  <div class="grid">
    <input id="batsman2Name" type="text" placeholder="Batsman 2">
    <input id="batsman2R" type="number" placeholder="R" value="0" oninput="updateCalculations()">
    <input id="batsman2B" type="number" placeholder="B" value="0" oninput="updateCalculations()">
    <input id="batsman2F" type="number" placeholder="4s" value="0">
    <input id="batsman2S" type="number" placeholder="6s" value="0">
    <input id="batsman2SR" type="text" placeholder="SR" readonly>
  </div>

  <!-- Bowler Section -->
  <h3>Bowler</h3>
  <div class="grid">
    <input id="bowlerName" type="text" placeholder="Bowler Name">
    <input id="bowlerO" type="text" placeholder="Overs" value="0.0" oninput="updateCalculations()">
    <input id="bowlerR" type="number" placeholder="Runs" value="0" oninput="updateCalculations()">
    <input id="bowlerW" type="number" placeholder="Wickets" value="0">
    <input id="bowlerEco" type="text" placeholder="Eco" readonly>
  </div>

  <!-- Buttons for Last 6 Balls -->
  <div class="ball-buttons">
    <button class="ball-btn zero" onclick="addBall('0')">0</button>
    <button class="ball-btn run" onclick="addBall('1')">1</button>
    <button class="ball-btn run" onclick="addBall('2')">2</button>
    <button class="ball-btn run" onclick="addBall('3')">3</button>
    <button class="ball-btn four" onclick="addBall('4')">4</button>
    <button class="ball-btn six" onclick="addBall('6')">6</button>
    <button class="ball-btn wicket" onclick="addBall('W')">W</button>
    <button class="ball-btn extra" onclick="addBall('Nb')">Nb</button>
    <button class="ball-btn extra" onclick="addBall('Wd')">Wd</button>
    <button class="ball-btn extra" onclick="addBall('Lb')">Lb</button>
  </div>

  <button class="btn" onclick="saveData()">Save Score</button>
  <p id="result"></p>

  <script>
    function updateCalculations() {
      // Strike Rate calculation
      let r1 = parseInt(document.getElementById('batsman1R').value) || 0;
      let b1 = parseInt(document.getElementById('batsman1B').value) || 0;
      document.getElementById('batsman1SR').value = b1 > 0 ? ((r1 / b1) * 100).toFixed(1) : "0.0";

      let r2 = parseInt(document.getElementById('batsman2R').value) || 0;
      let b2 = parseInt(document.getElementById('batsman2B').value) || 0;
      document.getElementById('batsman2SR').value = b2 > 0 ? ((r2 / b2) * 100).toFixed(1) : "0.0";

      // Economy calculation
      let bo = document.getElementById('bowlerO').value;
      let bruns = parseInt(document.getElementById('bowlerR').value) || 0;
      let oversFloat = convertOversToFloat(bo);
      document.getElementById('bowlerEco').value = oversFloat > 0 ? (bruns / oversFloat).toFixed(2) : "0.0";
    }

    function convertOversToFloat(overs) {
      if (!overs.includes('.')) return parseInt(overs);
      let [o, b] = overs.split('.').map(Number);
      return o + b / 6;
    }

    function addBall(symbol) {
      let last6 = document.getElementById('last6');
      let balls = last6.value.split(' ').filter(Boolean);
      if (balls.length >= 6) balls.shift();
      balls.push(symbol);
      last6.value = balls.join(' ');
    }

    async function saveData() {
      let data = {
        teamA: document.getElementById('teamA').value,
        teamB: document.getElementById('teamB').value,
        target: document.getElementById('target').value ? parseInt(document.getElementById('target').value) : null,
        targetWickets: document.getElementById('targetWickets').value ? parseInt(document.getElementById('targetWickets').value) : null,
        runs: parseInt(document.getElementById('runs').value),
        wickets: parseInt(document.getElementById('wickets').value),
        overs: document.getElementById('overs').value,
        last6: document.getElementById('last6').value,
        batsman1: {
          name: document.getElementById('batsman1Name').value,
          runs: parseInt(document.getElementById('batsman1R').value),
          balls: parseInt(document.getElementById('batsman1B').value),
          fours: parseInt(document.getElementById('batsman1F').value),
          sixes: parseInt(document.getElementById('batsman1S').value),
          sr: document.getElementById('batsman1SR').value
        },
        batsman2: {
          name: document.getElementById('batsman2Name').value,
          runs: parseInt(document.getElementById('batsman2R').value),
          balls: parseInt(document.getElementById('batsman2B').value),
          fours: parseInt(document.getElementById('batsman2F').value),
          sixes: parseInt(document.getElementById('batsman2S').value),
          sr: document.getElementById('batsman2SR').value
        },
        bowler: {
          name: document.getElementById('bowlerName').value,
          overs: document.getElementById('bowlerO').value,
          runs: parseInt(document.getElementById('bowlerR').value),
          wickets: parseInt(document.getElementById('bowlerW').value),
          eco: document.getElementById('bowlerEco').value
        }
      };

      let response = await fetch('update.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ score: data })
      });
      let result = await response.text();
      document.getElementById('result').innerText = result;
    }
  </script>
</body>
</html>